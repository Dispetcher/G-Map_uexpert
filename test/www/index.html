<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Complex icons</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
      }
      #map {
        height: 800px;
        width:70vw;
      }
      #floating-panel {
        position: absolute;
        top: 10px;
        left: 25%;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
        font-family: 'Times New Roman';
        line-height: 30px;
        padding-left: 10px;
      }
      #floating-panel {
        margin-left: -52px;

      </style>
  </head>
  <body>
    <div id="map"></div>
      <div id="floating-panel">
      <button id="drop" onclick="dropAll()">Drop Markers</button>
      <button id="clear" onclick="removeLine()">Remove</button>
    </div>

    <script>
var marker;
var markers = [];
var map;
var linePath;
var polyLine = [];
var linepatharr= [];

var redline = '#d52d2d';
var blueline= '2a0acb';
var greenline= '#034f0d';
var orangeline= '#ff6500';
var violetline= '#60008a';

var cRedIcon;
var cBlueIcon;
var cGreenIcon;
var cOrangeIcon = {url: 'Imgs/constructionOrange24.png'};
var cVioletIcon = {url: 'Imgs/constructionViolet24.png'};
var cBrownIcon;

var pRedIcon;
var pBlueIcon;
var pGreenIcon;
var pOrangeIcon;
var pVioletIcon;
var pBrownIcon;

/*Описание станций в строительстве*/
var containerConstr = [
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>']
];

/*Описание станций в проектировании*/
var containerProj = [
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>'],
['<h2 class="content__header">«Планерная»</h2>'+
'<div class="content__body"><p><b>Время постройки</b> - до 2025 года, <b>Линия</b> - Невско-Василеостровская (3 линия «Зеленая»)</p>'+
'<p><b>Адрес</b> - Для размещения вестибюля этой станции рассматривается несколько вариантов: пересечение Планерной улицы с Шуваловским проспектом, пересечение Шуваловского проспекта с проспектом Авиаконструкторов, а также на самой Планерной улице вблизи планировавшегося нового зоопарка в Юнтолово</p>'+
'</div>']
];


function initMap() {
    var infowindow = new google.maps.InfoWindow();
    map = new google.maps.Map(document.getElementById('map'), {
    zoom: 11,
    center: {lat:59.940,lng:30.330},
    });

    dropAll(infowindow);
}

/*Блок строящихся станций*/
var constrs=[
['1', {lat: 59.823, lng: 30.429}, containerProj[0], cOrangeIcon, orangeline, 1.0, 3],
['2', {lat: 59.840, lng: 30.410}, containerProj[1], cOrangeIcon, orangeline, 0, 0],
['3', {lat: 59.926641, lng: 30.297492}, containerProj[1], cVioletIcon, violetline, 1.0, 3],
['4', {lat: 59.973, lng: 30.211}, containerProj[1], cVioletIcon, violetline, 1.0, 3],
/*['5', {lat: 59.987, lng: 30.202}],
['6', {lat: 59.849, lng: 30.330}]
['7', lat: 59.932, lng: 30.261],
['8', lat: 59.860, lng: 30.230],
['9', lat: 59.881, lng: 30.266]*/
];

/*Блок проектируемых станций*/
var projects=[];

/*Блок станций 3 линии (зеленый)*/
var l3st= [];

/*Блок станций 4 линии (оранжевый)*/
var l4st= [];

/*Блок станций 5 линии (фиолетовый)*/
var l5st= [];

/*Блок станций 6 линии (коричневый)*/
var l6st= [];

/*Функция опускающая маркеры и рисующая линии при инициализации карты*/
function dropAll(infowindow){
  dropConStation(infowindow);
  dropProjStation(infowindow);
  /*dropl3st();
  dropl4st();
  dropl5st();
  dropl6st();*/
}

/*Опускаем станции и рисуем линии в стройке*/
function dropConStation(infowindow) {
  clearMarkers();
  removeLine();
    for (var i = 0; i < constrs.length; i++) {
      if (i != constrs.length-1){
      var constr = constrs[i];
      var constrN = constrs[i+1];
      var linepatharr = [constr[1],constrN[1]]; 

      addMarkerWithTimeout(constr[0], constr[1], constr[2], constr[3], i * 100, infowindow);
      addLine(linepatharr, constr[4], constr[5], constr[6]);
      };

      var constr = constrs[i];
      addMarkerWithTimeout(constr[0], constr[1], constr[2], constr[3], i * 100, infowindow);
    }
}

/*Опускаем станции и рисуем линии в проекте*/
function dropProjStation(infowindow) {
  clearMarkers();
    for (var i = 0; i < projects.length; i++) {
      if (i != projects.length-1){
      var project = projects[i];
      var projectN = projects[i];
      var linepatharr = [project[1], projectN[1]];

      addMarkerWithTimeout(project[0], project[1], project[2], i * 100);
      addLine(linepatharr, project[3], project[4], project[5]);
    };

      var project = projects[i];
      addMarkerWithTimeout(project[0], project[1], project[2], i * 100);
    }
}
/*Опускаем станции и рисуем линии на 3 линии*/
function dropl3st() {
    for (var i = 0; i < l3st.length; i++) {
      if (i != l3st.length-1){
      var l3 = l3st[i];
      var l3N = l3st[i+1];
      var linepatharr = [l3[1],l3N[1]]; 

      addMarkerWithTimeout(l3[0], l3[1], l3[2], i * 100);
      addLine(linepatharr, l3[3], l3[4], l3[5]);
      };

      var l3 = l3st[i];
      addMarkerWithTimeout(l3[0], l3[1], l3[2], i * 100);
    }
}
/*Опускаем станции и рисуем линии на 4 линии*/
function dropl4st() {
    for (var i = 0; i < l4st.length; i++) {
      if (i != l4st.length-1){
      var l4 = l4st[i];
      var l4N = l4st[i+1];
      var linepatharr = [l4[1],l4N[1]]; 

      addMarkerWithTimeout(l4[0], l4[1], l4[2], i * 100);
      addLine(linepatharr, l4[3], l4[4], l4[5]);
      };

      var l4 = l4st[i];
      addMarkerWithTimeout(l4[0], l4[1], l4[2], i * 100);
    }
}

/*Опускаем станции и рисуем линии на 5 линии*/
function dropl5st() {
    for (var i = 0; i < l5st.length; i++) {
      if (i != l5st.length-1){
      var l5 = l5st[i];
      var l5N = l5st[i+1];
      var linepatharr = [l5[1],l5N[1]]; 

      addMarkerWithTimeout(l5[0], l5[1], l5[2], i * 100);
      addLine(linepatharr, l5[3], l5[4], l5[5]);
      };

      var l5 = l5st[i];
      addMarkerWithTimeout(l5[0], l5[1], l5[2], i * 100);
    }
}

/*Опускаем станции и рисуем линии на 6 линии*/
function dropl6st() {
    for (var i = 0; i < l6st.length; i++) {
      if (i != l6st.length-1){
      var l6 = l6st[i];
      var l6N = l6st[i+1];
      var linepatharr = [l6[1],l6N[1]]; 

      addMarkerWithTimeout(l6[0], l6[1], l6[2], i * 100);
      addLine(linepatharr, l6[3], l6[4], l6[5]);
      };

      var l6 = l6st[i];
      addMarkerWithTimeout(l6[0], l6[1], l6[2], i * 100);
    }
}

/*Добавление линии на карту*/
function addLine(linepatharr, linecolor, lineOp, lineW) {
  linePath = new google.maps.Polyline({
          path: linepatharr,
          strokeColor: linecolor,
          strokeOpacity: lineOp,
          strokeWeight: lineW,
          map: map
        });
//linePath.setMap(map);
polyLine.push(linePath);
}

  /*Функция определяющая значения маркера (определение одного маркера)*/
function addMarkerWithTimeout(title, position, text, img, timeout, infowindow) {
  window.setTimeout(function() {
    marker = new google.maps.Marker({
      position: position,
      title: title,
      icon: img,
      map: map,
      animation: google.maps.Animation.DROP
    });
    google.maps.event.addListener(marker, 'click', function(){
      infowindow.close;
      infowindow.setContent("<div class='content'>"+text+"</div>");
      infowindow.open(map, this);
    });
    markers.push(marker);
  }, timeout);
}


  /*Удаление всех маркеров с карты*/
function clearMarkers() {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(null);
  }
  markers = [];
}
/*Удалении нарисованных линий с карты*/
function removeLine() {
  for (var i = 0; i < polyLine.length; i++) {
    polyLine[i].setMap(null);
  }
  polyLine = [];
}

       </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDRTPdt0Qs9GVAsnrKy-pL0rjV1p8S5D0E&callback=initMap">
    </script>
  </body>
</html>